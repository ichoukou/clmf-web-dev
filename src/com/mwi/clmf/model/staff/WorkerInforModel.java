package com.mwi.clmf.model.staff;import java.util.List;import com.jfinal.plugin.activerecord.Db;import com.jfinal.plugin.activerecord.Model;import com.jfinal.plugin.activerecord.Page;@SuppressWarnings("serial")public class WorkerInforModel extends Model<WorkerInforModel>{		public static final WorkerInforModel wiDao = new WorkerInforModel();		public List<WorkerInforModel> getWorkerByGuestId(Long guestId, String workType){		return wiDao.find("select * from cf_worker_infor where id in (select worker_id from cf_match where guest_id = ? and worker_type = ?)", guestId, workType);	}		public Page<WorkerInforModel> workerList(int pageNumber, int pageSize){		String sqlPrefix = "select *";		String sqlSurfix = "from cf_worker_infor wi left join cf_group g on wi.group_id = g.id where 1=1";				return wiDao.paginate(pageNumber, pageSize, sqlPrefix, sqlSurfix);	}		public Page<WorkerInforModel> workerList4Match(int pageNumber, int pageSize, String realName, String groupName, String workingStatus, String workerType, String post, String unit){		String sqlPrefix = "select *, wi.id workerId";		String sqlSurfix = "from cf_worker_infor wi where wi.worker_type = '"+workerType+"'";				if(realName != null && !"".equals(realName)){			sqlSurfix = sqlSurfix + " and wi.realname like '%"+realName+"%'";		}				if(groupName != null && !"".equals(groupName)){			System.out.println(groupName);			sqlSurfix = sqlSurfix + " and wi.work_group like '%"+groupName+"%'";		}				if(workingStatus != null && !"".equals(workingStatus)){			sqlSurfix = sqlSurfix + " and wi.working_state = '"+workingStatus+"'";		}				if(post != null && !"".equals(post)){			sqlSurfix = sqlSurfix + " and wi.post like '%"+post+"%'";		}				if(unit != null && !"".equals(unit)){			sqlSurfix = sqlSurfix + " and wi.unit like '%"+unit+"%'";		}				return wiDao.paginate(pageNumber, pageSize, sqlPrefix, sqlSurfix);	}		public Page<WorkerInforModel> workerWithCheckRuleList(int pageNumber, int pageSize, String workerType, String realName, String sex, String unit, String post, String groupName, String isBind){		String sqlPrefix = "select *, wi.id workerId";		String sqlSurfix = "from cf_worker_infor wi left join cf_group g on wi.group_id = g.id where worker_type = '"+workerType+"'";				if(realName != null && !"".equals(realName)){			sqlSurfix = sqlSurfix + " and wi.realname like '%"+realName+"%'";		}				if(sex != null && !"".equals(sex)){			sqlSurfix = sqlSurfix + " and wi.sex = '"+sex+"'";		}				if(unit != null && !"".equals(unit)){			sqlSurfix = sqlSurfix + " and wi.unit like '%"+unit+"%'";		}				if(post != null && !"".equals(post)){			sqlSurfix = sqlSurfix + " and wi.post like '%"+post+"%'";		}				if(groupName != null && !"".equals(groupName)){			sqlSurfix = sqlSurfix + " and g.group_name like '%"+groupName+"%'";		}				if(isBind != null && !"".equals(isBind)){			sqlSurfix = sqlSurfix + " and wi.is_bind_checkStand = '"+isBind+"'";		} 		return wiDao.paginate(pageNumber, pageSize, sqlPrefix, sqlSurfix);	}		public boolean deletByGuestId(Long guestId){		boolean delSuc = false;		int num = Db.update("delete from cf_match where guest_id = ?", guestId);		if(num != -1){			delSuc = true;		}		return delSuc;	}		public Page<WorkerInforModel> getWorkerList(String realname, String work_group,			String unit, String post, String skill, String id_no, String phone, String wechat_uesrname, int currentPage, int currentSize, int worker_type){		boolean realnameNotNull = !"".equals(realname) && realname != null;		boolean work_groupNotNull = !"".equals(work_group) && work_group != null;		boolean unitNotNull = !"".equals(unit) && unit != null;		boolean postNotNull = !"".equals(post) && post != null;		boolean skillNotNull = !"".equals(skill) && skill != null;		boolean id_noNotNull = !"".equals(id_no) && id_no != null;		boolean phoneNotNull = !"".equals(phone) && phone != null;		boolean wechat_uesrnameNull = !"".equals(wechat_uesrname) && wechat_uesrname != null;				String sql = "from cf_worker_infor cw where 1=1  ";		if(realnameNotNull)			sql += " and cw.realname like '%"+realname+"%'";		if(work_groupNotNull)			sql += " and cw.work_group like '%"+work_group+"%'";		if(unitNotNull)			sql += " and cw.unit like '%"+unit+"%'";		if(postNotNull)			sql += " and cw.post like '%"+post+"%'";		if(skillNotNull)			sql += " and cw.skill like '%"+skill+"%'";		if(worker_type == 1)			sql += " and cw.worker_type=1";		if(worker_type == 2)			sql += " and cw.worker_type=2";		if(id_noNotNull)			sql += " and cw.id_no like '%"+post+"%'";		if(phoneNotNull)			sql += " and cw.phone like '%"+phone+"%'";		if(wechat_uesrnameNull)			sql += " and cw.wechat_username like '%"+wechat_uesrname+"%'";		System.out.println("last sql:--"+sql);		sql += " order by cw.id  desc";		return wiDao.paginate(currentPage, currentSize, "select *,(select cc.license_num from cf_chack_card cc where cc.id=cw.card_id)cardNum", sql);			}		public WorkerInforModel getWorkerByName(String name, String email, String worker_type){		return wiDao.findFirst("select * from cf_worker_infor where realname=? and email=? and worker_type=?", name, email, worker_type);	}		public Page<WorkerInforModel> workerInfor4License(int pageNumber, int pageSize, String workerType, String realName, String unit, String post, String groupName, String licenseNum){		String sqlPrefix = "select *, wi.id workerId";		String sqlSurfix = "from cf_worker_infor wi left join cf_chack_card cc on wi.card_id = cc.id where worker_type = '"+workerType+"'";				if(realName != null && !"".equals(realName)){			sqlSurfix = sqlSurfix + " and wi.realname like '%"+realName+"%'";		}				if(unit != null && !"".equals(unit)){			sqlSurfix = sqlSurfix + " and wi.unit like '%"+unit+"%'";		}				if(post != null && !"".equals(post)){			sqlSurfix = sqlSurfix + " and wi.post like '%"+post+"%'";		}				if(groupName != null && !"".equals(groupName)){			sqlSurfix = sqlSurfix + " and wi.work_group like '%"+groupName+"%'";		}				if(licenseNum != null && !"".equals(licenseNum)){			sqlSurfix = sqlSurfix + " and cc.license_num like '%"+licenseNum+"%'";		}		return wiDao.paginate(pageNumber, pageSize, sqlPrefix, sqlSurfix);	}		public WorkerInforModel getWorkerById_no(String id_no, int worker_type){		String sql = "select *,(select cc.license_num from cf_chack_card cc where cc.id=cw.card_id)cardNum from cf_worker_infor cw where 1=1 and cw.id_no = '"+id_no+"' ";		if(worker_type == 1)			sql += " and cw.worker_type=1";		if(worker_type == 2)			sql += " and cw.worker_type=2";		System.out.println("last sql:--"+sql);		return wiDao.findFirst(sql);					}	}